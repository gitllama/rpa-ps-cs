# 1. RPA(PowerAutomate Desktop) - powershell script - c# script

## 1-1. Version確認

特に詳しい説明なしにとりあえず動かしてみる。Versionがわからないと動かないとき困りますからね。

Robin(PowerAutomate Desktop) code

```powershell
Scripting.RunPowershellScript Script: $'''Add-Type -TypeDefinition @\'
using System;
using System.Runtime.InteropServices;

public class Class1
{
  public static string Ver()
  {
    return RuntimeInformation.FrameworkDescription;
  }
}
\'@ -Language CSharp

$hash = @{}
$hash[\"ps_var\"] = $PSVersionTable.PSVersion
$hash[\"cs_var\"] = [Class1]::Ver()
ConvertTo-Json $hash''' ScriptOutput=> Out ScriptError=> ScriptError

# [ControlRepository][PowerAutomateDesktop]

{
  "ControlRepositorySymbols": [],
  "ImageRepositorySymbol": {
    "Name": "imgrepo",
    "ImportMetadata": {},
    "Repository": "{\r\n  \"Folders\": [],\r\n  \"Images\": [],\r\n  \"Version\": 1\r\n}"
  }
}

```

powershell scriptを抜き出したもの

```powershell
Add-Type -TypeDefinition @\'
using System;
using System.Runtime.InteropServices;

public class Class1
{
  public static string Ver()
  {
    return RuntimeInformation.FrameworkDescription;
  }
}
\'@ -Language CSharp

$hash = @{}
$hash[\"ps_var\"] = $PSVersionTable.PSVersion
$hash[\"cs_var\"] = [Class1]::Ver()
ConvertTo-Json $hash
```
